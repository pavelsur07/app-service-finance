# Открытые вопросы по транзакциям и пересчёту остатков

## По транзакциям (CRUD)
- Нужно ли логировать причину отказа при закрытом периоде (кто/когда/какая дата транзакции)?
- Что делать с транзакциями, попадающими ровно на дату `financeLockBefore`: разрешать или запрещать?
- Разрешать ли редактировать «несущественные» поля (описание, контрагент) в закрытом периоде, если дата/сумма не меняются?
- Нужен ли массовый импорт с автоматической проверкой на закрытый период и пакетными ошибками?

## Пересчёт остатков
- Точная правая граница пересчёта при CRUD: «сегодня» или максимум даты фактов по счёту (как сейчас в сервисе DailyBalanceRecalculator)?
- Нужен ли фоновой пересчёт очередью для тяжёлых периодов или оставляем синхронный?
- Стоит ли кэшировать «последнюю дату факта» по счёту на уровне сервиса (а не только в подписчике)?

## UI/UX
- Где ещё показывать блокировку периода: только флеш-сообщение или баннер на страницах транзакций?
- Надо ли подсветить в форме дату красным, если она < `financeLockBefore` (валидатор на клиенте)?
- Нужна ли кнопка «Запросить разблокировку периода» (workflow)?

## Права и безопасность
- Кто может менять `financeLockBefore`? Только админ компании?
- Нужен ли аудит изменений поля блокировки (old → new)?

## Отчёты
- Как вести себя отчётам, если есть транзакции «исторически» до блокировки, но пользователь пытается их изменить — показывать маркеры «locked»?
- Требуется ли быстрый отчёт «расхождение факты vs транзакции» после пересчёта?

## Тесты и сопровождение
- Пишем ли unit/functional тесты для кейсов CRUD + lock + пересчёт?
- Нужен ли CLI для массового «запечатывания» периода (установка `financeLockBefore` и пересчёт до границы)?
